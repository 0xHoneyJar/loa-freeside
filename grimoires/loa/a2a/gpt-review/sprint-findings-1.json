{
  "verdict": "CHANGES_REQUIRED",
  "summary": "This plan is close, but it has a few missing/incorrect dependencies and at least one unscoped critical validation task that can realistically prevent the Sprint 2 and Sprint 3 gates from being achievable.",
  "blocking_issues": [
    {
      "location": "Sprint 2 Gate + Task 2.6 (docs/INFRASTRUCTURE.md)",
      "issue": "Sprint 2 gate requires `terraform plan` clean, but there is no explicit task to create a runnable Terraform plan harness (backend/workspace/vars) or to define the exact invocation/environment that will be used to satisfy the gate.",
      "why_blocking": "In many repos, `terraform plan` fails by default without backend config, required variables, provider auth, or selecting the correct module path. Without a defined harness, the gate can fail even if the documentation is correct, and the engineer will burn time debugging infra rather than writing docs.",
      "fix": "Add a P0 task in Sprint 2 (or expand S305-T6 AC) to: (1) specify the exact module directory to run from, (2) provide a minimal `terraform.tfvars.example` (or documented env var set) that satisfies required variables with safe dummy values, (3) document/implement a local plan command (e.g., `scripts/tf-plan.sh`) that runs `terraform init` + `terraform validate` + `terraform plan` with `-backend=false` if appropriate, and (4) define acceptance as 'script exits 0 in CI/local without cloud credentials' (or explicitly require AWS creds if that’s intended)."
    },
    {
      "location": "Sprint 2 Tasks 2.2 (API-QUICKSTART) + 2.3 (API-REFERENCE)",
      "issue": "The plan depends on '7 guaranteed-stable endpoints' but does not include a task to identify/lock that endpoint set from the codebase (source-of-truth list) before writing docs and tests.",
      "why_blocking": "If the endpoint set is ambiguous, the quickstart, reference, smoke checklist, and stability labeling can’t be validated consistently. This can cascade into Sprint 2 gate failure (7/7 smoke tests) and Sprint 3 RTFM completeness checks because reviewers will dispute what the 7 endpoints are.",
      "fix": "Add a small P0/P1 task (before S305-T2) to define the stable endpoint list in a single canonical place (e.g., `docs/api/stable-endpoints.json` or a table in API-REFERENCE) with method+path+auth+purpose, and reference it from both QUICKSTART and REFERENCE. Update AC to require the smoke-test checklist to be generated from that list."
    },
    {
      "location": "Sprint 2 Task 2.4 (Tier 2 Contract Checks)",
      "issue": "Acceptance criteria require runtime introspection via `app._router.stack`, which is framework-specific and may not exist or may not be accessible depending on how the server is structured/exported.",
      "why_blocking": "If the app instance isn’t directly importable (common in production setups) or the router internals differ (Express vs Fastify vs Nest vs custom), this task can become a time sink or impossible, blocking the Sprint 2 gate and downstream Sprint 3 'route index completeness' validation.",
      "fix": "Change AC to a framework-agnostic check: start the dev server and validate extracted routes by making HTTP requests (HEAD/OPTIONS/GET with safe defaults) and asserting 'not 404' + auth behavior. Make runtime introspection optional ('if available') rather than required, or explicitly add a prerequisite task to expose an introspection endpoint in dev-only builds."
    },
    {
      "location": "Sprint 3 Task 3.4 (RTFM Full Validation) + overall plan",
      "issue": "RTFM validation is treated as a gate, but the plan does not include tasks to implement the RTFM validator itself (or to confirm it already exists), including the '8 RTFM checks' referenced in AC/testing.",
      "why_blocking": "If the RTFM pipeline/scripts don’t already exist, Sprint 3 cannot complete because the gate is defined in terms of tooling that may be missing. Even if some scripts exist (pin-citations, butterfreezone-validate), the cross-link check, TODO/TBD scan, naming scan across the correct file set, version consistency check, and route baseline check need an executable harness.",
      "fix": "Add an explicit task (likely Sprint 3 P0, or earlier) to implement `scripts/rtfm-validate.sh` (or equivalent) that runs the named checks with deterministic exit codes and a documented file allowlist. If it already exists, add an AC to S306-T4 that references the exact script path and enumerates the checks it runs, plus a 'dry run' in Sprint 1/2 to de-risk."
    },
    {
      "location": "Sprint 1 Task 1.2 (BUTTERFREEZONE regeneration)",
      "issue": "Task requires jq >= 1.7, but jq 1.7 is not broadly available on many default environments yet; also no task defines how CI/dev will obtain jq 1.7.",
      "why_blocking": "This can cause immediate failure of generation/validation on the engineer’s machine or CI, blocking Sprint 1 gate and cascading into all later gates (hash validation is required in Sprint 3).",
      "fix": "Either (a) relax requirement to jq >= 1.6 with a deterministic canonicalization approach compatible with 1.6, or (b) add a task/AC to vendor jq (e.g., via `mise`, `asdf`, `brew`, or a pinned container) and ensure scripts run in that environment. Also specify the CI runner environment that satisfies the jq constraint."
    }
  ],
  "question": "",
  "iteration": 1
}
