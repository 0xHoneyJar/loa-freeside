{
  "verdict": "CHANGES_REQUIRED",
  "summary": "As written, Sprints 4–5 risk failing because key dependencies and validation gates are inconsistent with the existing tooling model (8-check RTFM, MANAGED_DOCS scope) and several Sprint 4 claims are not verifiably grounded in this repo without explicit source-confirmation tasks.",
  "blocking_issues": [
    {
      "location": "Sprint 4 / S307-T1 (ECONOMICS.md)",
      "issue": "Doc outline asserts specific files/behaviors (e.g., `packages/adapters/agent/budget-manager.ts`, `budget-reserve.lua`, `budget-finalize.lua`, “14 canonical properties imported from loa-hounfour”, specific error codes, TierService thresholds, pool-mapping conformance tests) without a task to confirm these sources exist in loa-freeside and are the actual canonical implementations.",
      "why_blocking": "If any referenced files/types/tests don’t exist (or live in different paths/repos), you cannot meet the acceptance criteria requiring exact matches and citation-backed grounding; the sprint will stall in citation validation and/or content correctness.",
      "fix": "Add an explicit first step (or subtask) to S307-T1: “Source-of-truth discovery + path verification” with acceptance criteria like: (1) list exact repo paths + line ranges for each major section, (2) confirm whether invariants/error codes live in loa-freeside vs loa-hounfour and adjust doc scope accordingly, (3) update outline to only include primitives that can be cited from confirmed sources. If cross-repo is required, add a task to pin those citations via commit SHA permalinks."
    },
    {
      "location": "Sprint 4 / S307-T2 (EVENT-PROTOCOL.md)",
      "issue": "Acceptance criteria hard-codes “3 JetStream streams: COMMANDS, EVENTS, ELIGIBILITY” and “All 7 known event types” plus specific schema file paths, but there is no verification task ensuring these streams/types are actually defined in the referenced JSON/TS schema sources in this repo.",
      "why_blocking": "If the stream set or event-type count differs, the doc cannot satisfy “all 3 streams” / “all 7 event types” criteria and will fail review/citation checks; you’ll also risk documenting a protocol that doesn’t match production routing.",
      "fix": "Add a preflight verification step to S307-T2: extract stream names + subject patterns from `nats-routing.json` and event types from `gateway-event.ts` (or routing.ts) and set acceptance criteria to “document exactly what exists at pinned commit,” not a predetermined count. Keep the count-based criteria only if you first prove the count in-code and cite it."
    },
    {
      "location": "Sprint 4 / Dependency graph vs task dependencies",
      "issue": "S307-T1 depends on Sprint 3 complete, but S307-T2 is marked with no dependencies even though both tasks require citation pin/validation tooling introduced in Sprint 3 (pin-citations.sh, rtfm-validate.sh) and the Sprint 4 gate is “pass citation validation.”",
      "why_blocking": "If Sprint 3 artifacts are required to validate Sprint 4 gate, Sprint 4 tasks must explicitly depend on Sprint 3 completion; otherwise sequencing allows starting Sprint 4 without the ability to validate done-ness, causing rework and gate failure on Day 11.",
      "fix": "Make S307-T2 (and S307-T4 if it requires crosslink checks) explicitly depend on Sprint 3 complete, or restate Sprint 4 gate as “draft complete” and move validation to Sprint 5. Prefer: set S307-T2 dependency = Sprint 3 complete and add “run pin-citations --validate-only on both new docs” as part of Sprint 4 gate."
    },
    {
      "location": "Sprint 5 / Sprint 5 gate and Task 5.1",
      "issue": "Sprint 5 gate says “RTFM 10/10 checks pass,” but the plan and tooling definition earlier specify an 8-check RTFM validator; no tasks add two new checks or redefine scoring.",
      "why_blocking": "You cannot satisfy a gate that references a non-existent scoring model; this creates an unmeetable acceptance criterion and will block declaring Sprint 5 done even if the validator passes.",
      "fix": "Either (a) change Sprint 5 gate/AC to “RTFM 8/8 checks pass” (recommended), or (b) add tasks to implement the additional two checks, name them, define exit codes, and update CI to require them—then update all references consistently."
    },
    {
      "location": "Sprint 5 / S308-T1 (Update RTFM Validator for New Documents)",
      "issue": "Task says “Update the versions check if these docs include version headers,” but there is no Sprint 4 task requiring version headers in the new docs, and the existing version-consistency check is described as comparing package.json vs README badge and BUTTERFREEZONE (not per-doc headers).",
      "why_blocking": "This creates an ambiguous and potentially contradictory validation requirement: adding version headers could require expanding the validator logic, but that work is not specified; leaving them out could still pass, but the task implies it might be required.",
      "fix": "Decide and codify: either require version headers in ECONOMICS/EVENT-PROTOCOL (add to Sprint 4 AC) and explicitly update validator check #3 to validate them, or explicitly state “no per-doc version header validation; only README/BUTTERFREEZONE are checked” and remove the conditional language."
    },
    {
      "location": "Sprint 4 / S307-T4 (Route Extraction Coverage Note)",
      "issue": "Acceptance criteria text says “static grep-based extraction,” but Sprint 2 implemented ts-morph AST parsing; the note would be factually wrong and contradict existing tooling.",
      "why_blocking": "This is likely to fail review and can also cause future maintenance errors (developers will distrust docs/tooling alignment). It’s also directly tied to a Bridgebuilder finding; getting it wrong defeats the purpose of the sprint.",
      "fix": "Update S307-T4 acceptance criteria to match actual extraction method: “ts-morph AST-based static analysis of Express route registrations,” and cite `scripts/extract-routes.sh` implementation lines. Keep the limitation language (dynamic/computed paths, runtime registration, gateway-proxied routes) but make it accurate."
    },
    {
      "location": "Sprint 4 / S307-T3 (Cross-repo learning path) + RTFM crossrepo check",
      "issue": "S307-T3 requires cross-repo links, and RTFM check #5 forbids branch-relative GitHub links (main/develop/master), but there is no explicit task to pin cross-repo links to commit SHAs (or to ensure they comply with the crossrepo rule).",
      "why_blocking": "If you add cross-repo links as normal GitHub URLs, the validator will fail; if you try to pin them ad hoc, you may miss some and fail on Day 12 during full validation.",
      "fix": "Add explicit acceptance criteria to S307-T3: “All cross-repo links are commit-SHA permalinks or otherwise compliant with crossrepo rule,” and add a step to run `scripts/pin-citations.sh` (not just validate-only) for ECOSYSTEM.md after adding the section, or ensure the links are expressed via the citation system rather than raw GitHub URLs."
    }
  ],
  "question": "",
  "iteration": 1
}
